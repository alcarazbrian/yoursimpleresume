---
import "../styles/global.css";

interface Props {
	title: string;
	description?: string;
}

const {
	title,
	description = "Free ATS Friendly Resume Builder. Create a professional, machine-readable CV in minutes. No sign-up required.",
} = Astro.props;
---

<!doctype html>
<html lang="en">
	<head>
		<!-- Google tag (gtag.js) -->
		<script
			async
			src="https://www.googletagmanager.com/gtag/js?id=G-92V3WGWXM8"
		></script>
		<script>
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());

			gtag("config", "G-92V3WGWXM8");
		</script>
		<meta charset="UTF-8" />
		<meta name="description" content={description} />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<meta
			name="keywords"
			content="resume builder, cv maker, ats friendly, free resume builder, no sign up, pdf resume"
		/>
		<meta property="og:title" content={title} />
		<meta property="og:description" content={description} />
		<meta property="og:type" content="website" />
		<title>{title}</title>
	</head>
	<body class="bg-gray-50 text-gray-900 antialiased overflow-hidden h-screen">
		<slot />
		<div
			id="time-popup"
			class="fixed top-5 left-1/2 -translate-x-1/2 z-[99999] w-[95%] sm:w-fit sm:max-w-md bg-white border-l-4 border-indigo-600 shadow-2xl rounded-r-lg p-5 transform transition-all duration-500 ease-out translate-y-[-200%] opacity-0 pointer-events-none font-sans"
		>
			<div class="flex items-start gap-4">
				<div class="text-indigo-600 mt-1">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						class="h-6 w-6"
						fill="none"
						viewBox="0 0 24 24"
						stroke="currentColor"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
						></path>
					</svg>
				</div>

				<div class="flex-1">
					<h3 class="font-bold text-gray-800 text-sm">隆Hola! </h3>
					<p class="text-xs text-gray-600 mt-1 mb-3 leading-relaxed">
						Veo que estas haciendo tu CV. Espero que est茅 quedando
						genial.
						<br /><br />
						Esta herramienta es gratuita, sin registros y sin proporcionar
						datos personales.
						<br />
						Ay煤dame a seguir mejorando el proyecto 
					</p>

					<div class="flex flex-wrap gap-2">
						<a
							href="#"
							id="btn-mp-time-trigger"
							class="flex items-center gap-1 bg-[#009EE3] hover:bg-[#007eb5] text-white text-xs font-bold py-2 px-3 rounded transition-colors"
						>
							Mercado Pago
							<svg
								class="w-5 h-3.5 rounded-[1px] shadow-sm"
								viewBox="0 0 9 6"
								xmlns="http://www.w3.org/2000/svg"
							>
								<rect fill="#75AADB" width="9" height="6"
								></rect>
								<rect fill="#ffffff" y="2" width="9" height="2"
								></rect>
								<circle fill="#F6B40E" cx="4.5" cy="3" r="0.8"
								></circle>
							</svg>
						</a>

						<a
							href="https://paypal.me/levelastro"
							target="_blank"
							class="flex items-center gap-1 bg-[#003087] hover:bg-[#001c64] text-white text-xs font-bold py-2 px-3 rounded transition-colors"
						>
							PayPal 
						</a>
					</div>
				</div>

				<button
					id="close-time-popup"
					class="text-gray-400 hover:text-gray-600 p-1 transition-colors"
				>
					<svg
						xmlns="http://www.w3.org/2000/svg"
						class="h-4 w-4"
						fill="none"
						viewBox="0 0 24 24"
						stroke="currentColor"
					>
						<path
							stroke-linecap="round"
							stroke-linejoin="round"
							stroke-width="2"
							d="M6 18L18 6M6 6l12 12"></path>
					</svg>
				</button>
			</div>
		</div>

		<script>
			document.addEventListener("DOMContentLoaded", () => {
				const popup = document.getElementById("time-popup");
				const closeBtn = document.getElementById("close-time-popup");
				const mpTrigger = document.getElementById(
					"btn-mp-time-trigger",
				);

				// TIEMPOS
				// 5 minutos = 300000
				const TIEMPO_APARICION = 120000;
				// 1 minuto = 60000
				const DURACION_VISIBLE = 60000;

				if (!popup) return;

				let autoCloseTimer;

				// Funci贸n Mostrar
				const mostrarPopup = () => {
					popup.classList.remove(
						"translate-y-[-200%]",
						"opacity-0",
						"pointer-events-none",
					);

					// Auto-cierre
					autoCloseTimer = setTimeout(() => {
						cerrarPopup();
					}, DURACION_VISIBLE);
				};

				// Funci贸n Cerrar
				const cerrarPopup = () => {
					popup.classList.add(
						"translate-y-[-200%]",
						"opacity-0",
						"pointer-events-none",
					);
					clearTimeout(autoCloseTimer);
				};

				// Iniciar Timer
				setTimeout(() => {
					mostrarPopup();
				}, TIEMPO_APARICION);

				// Evento Cerrar (X)
				if (closeBtn) closeBtn.addEventListener("click", cerrarPopup);

				// Evento Mercado Pago
				if (mpTrigger) {
					mpTrigger.addEventListener("click", (e) => {
						e.preventDefault();

						// 1. CERRAR EL POPUP GIGANTE INMEDIATAMENTE
						// Esto hace que desaparezca para que se vea la notificaci贸n de atr谩s
						cerrarPopup();

						// 2. Activar la l贸gica original (Copiar alias)
						const originalMpBtn = document.getElementById("btn-mp");
						if (originalMpBtn) {
							// Peque帽o delay de 200ms para que la animaci贸n de cierre se vea fluida
							// antes de que salga el cartel de "Alias Copiado"
							setTimeout(() => {
								originalMpBtn.click();
							}, 200);
						}
					});
				}
			});
		</script>
	</body>
</html>
